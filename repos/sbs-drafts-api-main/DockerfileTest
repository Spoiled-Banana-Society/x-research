FROM golang:1.20-alpine

ENV GOOGLE_APPLICATION_CREDENTIALS=./configs/sbs-test-env-config.json
ENV ENVIRONMENT=dev
ENV TEST_GCP_CREDS_LOCATION=projects/1026708014901/secrets/sbs-test-env-config/versions/latest
ENV TEST_DRAFT_SERVER_BASE_URL=https://sbs-drafts-server-ajuy5qy3wa-uc.a.run.app

COPY . /usr/local/go/src/sbs-drafts-api

WORKDIR /usr/local/go/src/sbs-drafts-api

RUN go mod download

RUN go build -o /sbs-drafts-api

COPY ./configs/sbs-test-env-config.json ./configs/sbs-test-env-config.json

EXPOSE 8080

CMD [ "/sbs-drafts-api" ]